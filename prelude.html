<html>
	<head>
		<title>Lambda Calculator - Prelude</title>
		<link rel="stylesheet" type="text/css" href="css/lambda.css" />
		<link rel="stylesheet" type="text/css" href="css/bnf.css" />
		<link rel="reference" type="text/html" href="http://www.cs.bgu.ac.il/~elhadad/advpro/course4.html" />
	</head>
	<body>
		<h3>HTML-DOM &#955;-calculator</h3>
		<pre>
			The idea is to use HTML elements to represent &#955;-calculus expressions,
			and the Javascript runtime to evaluate them.

			This is not a very effecient or even practical means of implementation.
			However it does allow for a nice display of the expressions, and even
			some style.
		</pre>

		<p>
			<em>A STRING is any valid Javascript String</em>
		</p>

		<strong>&#955;-calculus grammar</strong>
		<span class="bnf-notation">
				<dl>
					<dt>&lt;expression&gt;</dt>
					<dd>&lt;var&gt;</dd>
					<dd>&lt;abstraction&gt;</dd>
					<dd>&lt;application&gt;</dd>
				</dl>
				<dl>
					<dt>&lt;var&gt;</dt>
					<dd>STRING</dd>
				</dl>
				<dl>
					<dt>&lt;abstraction&gt;</dt>
					<dd>(&#955;&lt;var&gt;. &lt;expression&gt;)</dd>
				</dl>
				<dl>
					<dt>&lt;application&gt;</dt>
					<dd>(&lt;expression&gt; &lt;expression&gt;)</dd>
				</dl>
		</span>

		<strong>&#955;-calculus HTML-DOM grammar</strong>
		<span class="bnf-notation">
				<dl>
					<dt>&lt;expression&gt;</dt>
					<dd>&lt;var&gt;</dd>
					<dd>&lt;abstraction&gt;</dd>
					<dd>&lt;application&gt;</dd>
				</dl>
				<dl>
					<dt>&lt;var&gt;</dt>
					<dd>&lt;VAR&gt;STRING&lt;/VAR&gt;</dd>
				</dl>
				<dl>
					<dt>&lt;abstraction&gt;</dt>
					<dd>&lt;DL&gt;&lt;DT&gt;&lt;var&gt;&lt;/DT&gt;&lt;DD&gt;&lt;expression&gt;&lt;/DD&gt;&lt;/DL&gt;</dd>
				</dl>
				<dl>
					<dt>&lt;application&gt;</dt>
					<dd>&lt;OL&gt;&lt;LI&gt;&lt;expression&gt;&lt;/LI&gt;&lt;LI&gt;&lt;expression&gt;&lt;/LI&gt;&lt;OL&gt;</dd>
				</dl>
		</span>

		<strong>&#955;-calculus axioms</strong>
		<pre>
			Evaluation in &#955;-calculus is defined by three simple reduction rules:

			1. &#945;-conversion
			2. &#946;-reduction
			3. &#951;-reduction

			&#945;-conversion can be defined semi-formally as:
			E[x&#8242;/x] &#8594; E&#8242; &#8801; E &#8743; x&#8242; &#8712; FV(E)

			Which means in expression E, x can be rewritten as x&#8242; yeilding
			an equivalent expression E&#8242; with the condition that x&#8242; is not bound in E 
			(FV is a function which returns the set of free-variables in its argument)

			&#946;-reduction can be defined semi-formally as:
			(E1 E2) &#8594; E1[E2/x] &#8594; E&#8242;

			Which means that in the application (E1 E2), E2 can be substituted
			for the formal parameter <em>x</em> in E1 to yeild a new expression E&#8242;

			&#951;-reduction can be defined semi-formally as:
			&#955;x. (E x) &#8594; E &#8743; x &#8713; FV(E)

			Which means that if the body of a &#955;-abstraction is the application
			of another expression to the formal argument, and the formal argument
			does not a free variable in E than you can simply reduce the expression
			to E.
		</pre>

		<h3>&#955;-calculus environment</h3>

		<strong>TRUE</strong>
		<div id="TRUE" class="lambda-exp">
			<dl>
				<dt><var>x</var></dt>
				<dd>
					<dl>
						<dt><var>y</var></dt>
						<dd>
							<var>x</var>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>FALSE</strong>
		<div id="FALSE" class="lambda-exp">
			<dl>
				<dt><var>x</var></dt>
				<dd>
					<dl>
						<dt><var>y</var></dt>
						<dd>
							<var>y</var>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>IF</strong>
		<div id="IF" class="lambda-exp">
			<dl>
				<dt><var>predicate</var></dt>
				<dd>
					<dl>
						<dt><var>consequent</var></dt>
						<dd>
							<dl>
								<dt><var>alternative</var></dt>
								<dd>
									<ol>
										<li>
											<ol>
												<li><var>predicate</var></li>
												<li><var>consequent</var></li>
											</ol>
										</li>
										<li><var>alternative</var></li>
									</ol>
								</dd>
							</dl>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>AND</strong>
		<div id="AND" class="lambda-exp">
			<dl>
				<dt><var>p</var></dt>
				<dd>
					<dl>
						<dt><var>q</var></dt>
						<dd>
							<ol>
								<li>
									<ol>
										<li><var>p</var></li>
										<li><var>q</var></li>
									</ol>
								</li>
								<li><var>FALSE</var>
							</ol>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>OR</strong>
		<div id="OR" class="lambda-exp">
			<dl>
				<dt><var>p</var></dt>
				<dd>
					<dl>
						<dt><var>q</var></dt>
						<dd>
							<ol>
							<li>
								<ol>
									<li><var>p</var></li>
									<li><var>TRUE</var></li>
								</ol>
							</li>
							<li><var>q</var></li>
							</ol>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>NOT</strong>
		<div id="NOT" class="lambda-exp">
			<dl>
				<dt><var>p</dt>
				<dd>
					<ol>
						<li>
							<ol>
								<li><var>p</var></li>
								<li><var>FALSE</var></li>
							</ol>
						</li>
						<li><var>TRUE</var></li>
					</ol>
				</dd>
			</dl>
		</div>

		<h4>Church Numerals</h4>

		<pre>
			SUCC allows us to define any number once we have 0.
		</pre>

		<strong>SUCC</strong>
		<div id="SUCC" class="lambda-exp">
			<dl>
				<dt><var>n</var>
				<dd>
					<dl>
						<dt><var>f</var></dt>
						<dd>
							<dl>
								<dt><var>x</var></dt>
								<dd>
									<ol>
										<li><var>f</var></li>
										<li>
											<ol>
												<li>
													<ol>
														<li><var>n</var></li>
														<li><var>f</var></li>
													</ol>
												</li>
												<li><var>x</var></li>
											</ol>
										</li>
									</ol>
								</dd>
							</dl>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<pre>
			Most examples only define ZERO - THREE in church numerals,
			and since each numeral is just SUCC applied to the previous
			one there is really no need to define more (really ZERO and
			SUCC should be all we need)

			But since its slow to have to compute ONE each time we need it,
			a few are defined here just for example.
		</pre>

		<strong>ZERO</strong>
		<em>It's &lt;FALSE&gt;, Surprise!</em>
		<div id="ZERO" class="lambda-exp">
			<var>FALSE</var>
		</div>

		<strong>ONE</strong>
		<div id="ONE" class="lambda-exp">
			<dl>
				<dt><var>f</var></dt>
				<dd>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>f</var></li>
								<li><var>x</var></li>
							</ol>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>TWO</strong>
		<div id="TWO" class="lambda-exp">
			<dl>
				<dt><var>f</var></dt>
				<dd>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>f</var></li>
								<li>
									<ol>
										<li><var>f</var></li>
										<li><var>x</var></li>
									</ol>
								</li>
							</ol>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<strong>THREE</strong>
		<div id="THREE" class="lambda-exp">
			<dl>
				<dt><var>f</var></dt>
				<dd>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>f</var></li>
								<li>
									<ol>
										<li><var>f</var></li>
										<li>
											<ol>
												<li><var>f</var></li>
												<li><var>x</var></li>
											</ol>
										</li>
									</ol>
								</li>
							</ol>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<pre>
			What good are numbers if you can't add them?
		</pre>

		<strong>PLUS</strong>
		<div id="PLUS" class="lambda-exp">
			<dl>
				<dt><var>m</var></dt>
				<dd>
					<dl>
						<dt><var>n</var></dt>
						<dd>
							<dl>
								<dt><var>f</var></dt>
								<dd>
									<dl>
										<dt><var>x</var></dt>
										<dd>
											<ol>
												<li><var>n</var></li>
												<li>
													<ol>
														<li><var>f</var></li>
														<li>
															<ol>
																<li>
																	<ol>
																		<li><var>m</var></li>
																		<li><var>f</var></li>
																	</ol>
																</li>
																<li><var>x</var>
															</ol>
														</li>
													</ol>
												</li>
											</ol>
										</dd>
									</dl>
								</dd>
							</dl>
						</dd>
					</dl>
				</dd>
			</dl>
		</div>

		<pre>
			Since the environment is the DOM, it makes sense that applications
			can use variables which exist elsewhere.
		</pre>

		<h3>&#955;-calculus expression</h3>

		<strong>Sanity Check our Number System</strong><br />
		<button onclick="prelude.compute_toplevel(document.getElementById('SUCC-ZERO-test'))">Reduce</button>
		<div id="SUCC-ZERO-test" class="lambda-exp">
			<ol>
				<li><var>SUCC</var></li>
				<li><var>ZERO</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('SUCC-TWO-test'))">Reduce</button>
		<div id="SUCC-TWO-test" class="lambda-exp">
			<ol>
				<li><var>SUCC</var></li>
				<li><var>TWO</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('PLUS-test'))">Reduce</button>
		<div id="PLUS-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li><var>PLUS</var></li>
						<li><var>TWO</var></li>
					</ol>
				</li>
				<li><var>THREE</var></li>
			</ol>
		</div>

		<strong>Testing variable expansion</strong><br />
		<button onclick="prelude.compute_toplevel(document.getElementById('TRUE-test'))">Reduce</button>
		<div id="TRUE-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li><var>TRUE</var></li>
						<li><var>1</var></li>
					</ol>
				</li>
				<li><var>-1</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('FALSE-test'))">Reduce</button>
		<div id="FALSE-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li><var>FALSE</var></li>
						<li><var>1</var></li>
					</ol>
				</li>
				<li><var>-1</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('IF-test'))">Reduce</button>
		<div id="IF-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li>
							<ol>
								<li><var>IF</var></li>
								<li><var>TRUE</var></li>
							</ol>
						</li>
						<li><var>Truth</var></li>
					</ol>
				</li>
				<li><var>Fiction</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('AND-test'))">Reduce</button>
		<div id="AND-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li><var>AND</var></li>
						<li><var>TRUE</var></li>
					</ol>
				</li>
				<li><var>FALSE</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('OR-test'))">Reduce</button>
		<div id="OR-test" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li><var>OR</var></li>
						<li><var>FALSE</var></li>
					</ol>
				</li>
				<li><var>TRUE</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('NOT-test'))">Reduce</button>
		<div id="NOT-test" class="lambda-exp">
			<ol>
				<li><var>NOT</var></li>
				<li><var>FALSE</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('FALSE-FALSE-test'))">Reduce</button>
		<div id="FALSE-FALSE-test" class="lambda-exp">
			<ol>
				<li><var>FALSE</var></li>
				<li><var>FALSE</var></li>
			</ol>
		</div>

		<strong>Here is a test of the reduction algorithm</strong><br />
		<button onclick="prelude.compute_toplevel(document.getElementById('lambda-calc')); return false">Reduce</button>
		<div id="lambda-calc" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li>
									<var>x</var>
								</li>
								<li>
									<var>World</var>
								</li>
							</ol>
						</dd>
					</dl>
				</li>
				<li>
					<var>Hello</var>
				</li>
			</ol>
		</div>

		<strong>Testing the free variable checkers</strong><br />
		<button onclick="alert(prelude.occurs_free(document.getElementById('yy-test'),document.getElementById('yy-test-y')) == false)">Assert y is not free</button>
		<div class="lambda-exp">
			<ol>
				<li>
					<dl id="yy-test">
						<dt><var>x</var>
						<dd>
							<dl>
								<dt><var>y</var>
								<dd>
									<ol>
										<li><var>x</var></li>
										<li><var>y</var></li>
									</ol>
								</dd>
							</dl>
						</dd>
					</dl>
				</li>
				<li><var id="yy-test-y">y</var></li>
			</ol>
		</div>
		<button onclick="alert(prelude.occurs_bound(document.getElementById('yz-test'),document.getElementById('yz-test-y')) == false)">Assert z is free</button>
		<div class="lambda-exp">
			<ol>
				<li>
					<dl id="yz-test">
						<dt><var>x</var>
						<dd>
							<dl>
								<dt><var>y</var>
								<dd>
									<ol>
										<li><var>x</var></li>
										<li><var>y</var></li>
									</ol>
								</dd>
							</dl>
						</dd>
					</dl>
				</li>
				<li><var id="yz-test-y">z</var></li>
			</ol>
		</div>

		<strong>Test FV</strong>
		<button onclick="console.log(prelude.FV(document.getElementById('fv-test-abx')))">Reveal FV set (<em>requires FireBug enabled</em>)</button>
		<div class="lambda-exp">
			<dl id="fv-test-abx">
				<dt><var>x</var></dt>
				<dd>
					<ol>
						<li><var>x</var></li>
						<li>
							<ol>
								<li><var>y</var></li>
								<li><var>z</var></li>
							</ol>
						</li>
					</ol>
				</dd>
			</dl>
		</div>

		<strong>Testing reduction</strong><br />
		<button onclick="prelude.compute_toplevel_x(document.getElementById('reduce-test-exp'))">Reduce</button>
		<div id="reduce-test-exp" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>P</var>
						<dd>
							<ol>
								<li><var>P</li>
								<li><var>j</li>
							</ol>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>Q</var></li>
								<li><var>x</var></li>
							</ol>
						</dd>
					</dl>
				</li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('reduce-test-exp-2'))">Reduce</button>
		<div id="reduce-test-exp-2" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>P</var></li>
								<li><var>x</var></li>
							</ol>
						</dd>
					</dl>
				</li>
				<li><var>j</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('reduce-test-exp-3'))">Reduce</button>
		<div id="reduce-test-exp-3" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
									<li>
									<ol>
										<li><var>K</var></li>
										<li><var>x</var></li>
									</ol>
								</li>
							<li><var>x</var></li>
							</ol>
						</dd>
					</dl>
				</li>
				<li><var>j</var></li>
			</ol>
		</div>

		<button onclick="prelude.compute_toplevel(document.getElementById('reduce-test-exp-4'))">Reduce</button>
		<div id="reduce-test-exp-4" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>x</var></li>
								<li><var>y</var></li>
							</ol>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt><var>z</var></dt>
						<dd><var>z</var></dd>
					</dl>
				</li>
			</ol>
		</div>

		<strong>Testing &#945;-conversion</strong>
		<button onclick="prelude.compute_toplevel(document.getElementById('alpha-reduction-test'))">Reduce</button>
		<div id="alpha-reduction-test" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<ol>
								<li><var>x</var></li>
								<li><var>x</var></li>
							</ol>
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<dl>
								<dt><var>y</var></dt>
								<dd>
									<ol>
										<li><var>x</var></li>
										<li><var>y</var></li>
									</ol>
								</dd>
							</dl>
						</dd>
					</dl>
				</li>
			</ol>
		</div>

		<strong>Another &#945;-conversion test</strong>
		<button onclick="prelude.compute_toplevel(document.getElementById('alpha-reduction-test-2'))">Reduce</button>
		<div id="alpha-reduction-test-2" class="lambda-exp">
			<ol>
				<li>
					<ol>
						<li>
							<dl>
								<dt><var>a</var></dt>
								<dd>
									<dl>
										<dt><var>b</var></dt>
										<dd>
											<ol>
												<li><var>b</var></li>
												<li><var>a</var></li>
											</ol>
										</dd>
									</dl>
								</dd>
							</dl>
						</li>
						<li><var>b</var></li>
					</ol>
				</li>
				<li><var>a</var></li>
			</ol>
		</div>

		<strong>Normal-order test, should reduce to 7... strict eval would never reduce</strong>
		<button onclick="prelude.compute_toplevel(document.getElementById('normal-order-test'))">Reduce</button>
		<div id="normal-order-test" class="lambda-exp">
			<ol>
				<li>
					<dl>
						<dt><var>x</var></dt>
						<dd>
							<var>7</var>
						</dd>
					</dl>
				</li>
				<li>
					<ol>
						<li>
							<dl>
								<dt><var>y</var></dt>
								<dd>
									<ol>
										<li><var>y</var></li>
										<li><var>y</var></li>
									</ol>
								</dd>
							</dl>
						</li>
						<li>
							<dl>
								<dt><var>y</var></dt>
								<dd>
									<ol>
										<li><var>y</var></li>
										<li><var>y</var></li>
									</ol>
								</dd>
							</dl>
						</li>
					</ol>
				</li>
			</ol>
		</div>

		<strong>&#951;-conversion test</strong>
		<button onclick="prelude.abstraction_eta_reduction(prelude.first_element_token(document.getElementById('eta-test')))">Reduce</button>
		<div id="eta-test" class="lambda-exp">
			<dl>
				<dt><var>x</var></dt>
				<dd>
					<ol>
						<li><var>square</var></li>
						<li><var>x</var></li>
					</ol>
				</dd>
			</dl>
		</div>

		<!-- bring in the lambda-calculator machinery -->
		<script src="js/lambda.js" type="text/javascript"></script>
	</body>
</html>
